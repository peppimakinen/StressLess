import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import{f as i}from"./fetch-CGUiTqyx.js";import{s as o}from"./snackbar-BNtgsuzo.js";window.addEventListener("load",()=>{u()});const c=document.querySelector(".LoginUser");c.addEventListener("click",async r=>{r.preventDefault();const t=document.querySelector(".LoginForm"),a=t.querySelector('input[name="LoginEmail"]'),n=t.querySelector('input[name="LoginPassword"]'),l="http://127.0.0.1:3000/api/auth/patient-login",s={username:a.value,password:n.value},m={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};try{const e=await i(l,m);console.log(e),localStorage.setItem("token",e.token),localStorage.setItem("user_email",e.user.username),localStorage.setItem("user_name",e.user.full_name),localStorage.setItem("user_level",e.user.user_level),localStorage.setItem("user_id",e.user.user_id),e.user.surveyCompleted?(o("Green","Kirjaudutaan sis채채n!"),setTimeout(()=>{window.location.href="../home/patienthome.html"},3e3)):(o("Green","Kirjaudutaan sis채채n!"),setTimeout(()=>{window.location.href="../survey/alkukartoitus.html"},3e3))}catch(e){console.error(e),o("Red","Error logging in")}});function u(){localStorage.removeItem("token"),localStorage.removeItem("user_id"),localStorage.removeItem("user_email"),localStorage.removeItem("user_name"),localStorage.removeItem("user_level"),localStorage.removeItem("Paired_doc_Name"),localStorage.removeItem("doc_name"),localStorage.removeItem("full_name"),localStorage.removeItem("entry_count"),localStorage.removeItem("username")}
