import"./modulepreload-polyfill-B5Qt9EMX.js";import{f as y}from"./fetch-CGUiTqyx.js";import{s as l}from"./snackbar-BNtgsuzo.js";window.addEventListener("DOMContentLoaded",async()=>{try{const s="https://hyte-server-aleksi.northeurope.cloudapp.azure.com/api/users/doctor/patients",p={method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("token")}},c=await y(s,p),a=document.querySelector(".clients");Object.keys(c).length===0?a.textContent="Käyttäjätililläsi ei ole vielä yhtään potilastiliä liitettynä.":c.forEach((e,E)=>{const t=document.createElement("li");t.classList.add("client-container");const i=document.createElement("span");i.classList.add("client-name"),i.textContent=e.full_name;const n=document.createElement("a");n.href=`../home/doctorhome.html?client=${e.user_id}`,n.textContent="Näytä asiakastili",n.addEventListener("click",function(r){localStorage.setItem("full_name",e.full_name)});const o=document.createElement("button");o.classList.add("delete"),o.textContent="X",o.dataset.userId=e.user_id,o.addEventListener("click",async function(r){r.preventDefault();const h=r.target.dataset.userId;document.getElementById("deleteModal").style.display="block";const m=document.querySelector(".close");m&&m.addEventListener("click",function(){document.getElementById("deleteModal").style.display="none"}),document.getElementById("confirmDeletion").addEventListener("click",async function(){if(document.getElementById("deleteConfirm").value==="Poista tili")try{if((await fetch(`https://hyte-server-aleksi.northeurope.cloudapp.azure.com/api/users/doctor/delete-patient/${h}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)l("Green","Tili poistettu onnistuneesti"),setTimeout(()=>{window.location.href="./patientSelection.html"},3e3),a.removeChild(t);else throw new Error("Failed to delete account")}catch(u){l("Red",u.message)}else l("Red","Poistaminen epäonnistui: väärä teksti");document.getElementById("deleteModal").style.display="none"})});const d=document.createElement("li");d.classList.add("client"),d.textContent=e.full_name,document.createElement("div").classList.add("reports"),n.href=`../home/doctorhome.html?client=${e.user_id}`,n.textContent="Näytä asiakastili",t.appendChild(o),t.appendChild(i),t.appendChild(n),a.appendChild(t)})}catch(s){console.error("Error fetching report:",s)}});
